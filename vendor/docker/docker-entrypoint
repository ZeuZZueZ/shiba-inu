#!/bin/bash -e

# Map environment variables to entries in logstash.yml.
# Note that this will mutate logstash.yml in place if any such settings are found.
# This may be undesirable, especially if logstash.yml is bind-mounted from the
# host system.
# env2yaml.go /usr/share/logstash/config/logstash.yml

if [[ -z $1 ]] || [[ ${1:0:1} == '-' ]] ; then
  exec logstash "$@"
else
  exec "$@"
fi

exec "dockerize -template vendor/docker/02_input_file.tmpl:/usr/share/logstash/pipeline/main/02_input_file.conf"
exec "dockerize -template vendor/docker/30_output_elasticsearch.tmpl:/usr/share/logstash/pipeline/main/30_output_elasticsearch.conf"

